<script language="JavaScript">var PUpage="76001067"; var PUprop="geocities"; </script><script language="JavaScript" src="http://www.geocities.com/js_source/pu5geo.js"></script><script language="JavaScript"> var thGetOv="http://themis.geocities.yahoo.com/themis/h.php"; var thCanURL="http://us.geocities.com/contactgirish/ftp.html"; var thSpaceId="76001067"; var thIP="194.6.230.193"; var thTs="1238062031"; var thCs="d263686500519e69326fb22e4744a774";</script><noscript><link rel="stylesheet" href="http://themis.geocities.yahoo.com/jsoff.css?thIP=194.6.230.193&thTs=1238062031"></noscript><script language="JavaScript" src="http://us.geocities.com/js_source/geovck08.js"></script>
<!-- text above generated by server. PLEASE REMOVE -->
<html>
<head>
<title>Using FTP from MFC</title>

<meta name="generator" content="Created Using Yahoo! PageBuilder 2.61.88">
<meta name="author" content="V.Girish">
<meta name="keywords" content="FTP MFC VC++ tutorial Source code reference">
</head>
<body background="http://www.geocities.com/contactgirish/border.jpg" bgcolor="#FFFFFF" link="#0000FF" vlink="#000099" text="#000000"
 onLoad="window.onresize=new Function('if (navigator.appVersion==\'Netscape\') history.go(0);');">
<!-- following code added by server. PLEASE REMOVE -->
<link href="http://us.geocities.com/js_source/div.css" rel="stylesheet" type="text/css"><script language="JavaScript" src="http://us.geocities.com/js_source/div03.js"></script>
<!-- preceding code added by server. PLEASE REMOVE -->
<div id="root" style="position:absolute;top:0;left:0;width:711px;height:1013px">
<div style="position:absolute;left:224;top:98;width:400;height:20;">
<table width=400 height=20 border=0 cellpadding=0 cellspacing=0><tr valign="top">
	<td valign="middle" align="center"><b><font color="#660000"><span style="font-size:14">Using FTP from your MFC application - Quick Reference</span></font></b></td>
</tr></table></div>
<div style="position:absolute;left:150;top:146;width:549;height:7;">
<table width=549 height=7 border=0 cellpadding=0 cellspacing=0><tr valign="top">
	<td><img height=7 width=549 src="http://www.geocities.com/clipart/pbi/hrules/Generic/yellow_back.gif" border=0 ></td>
</tr></table></div>
<div style="position:absolute;left:154;top:176;width:541;height:825;">
<table width=541 height=825 border=0 cellpadding=0 cellspacing=0><tr valign="top">
	<td><!-- FTP Tutorial -->
<html>
<body>

<h2>Introduction</h2><pre>
<p>Tutorial for using FTP</p></pre>
<h2>Description</h2><pre>
	This tutorial helps you to use FTP from your applications. You can 

	a) Connect to a FTP server and 
	b) Upload or Download files from and to the server.</pre>
<h2>Implementation</h2>
<h3>Step 1</h3><pre>
	Add the following statement in your header file.

	#include < afxinet.h ></pre>
<h3>Step 2</h3><pre>
	In your header file, add the following Member Variables
 
	CFtpConnection *m_pFtpConnection;
	CInternetSession m_Session;</pre>
<h3>Step 3</h3><pre>
	In your application's initialization ( OnInitDialog or InitInstance functions), 
	add the following lines.

	m_pFtpConnection = NULL;

	try
	{
	  // Here usr is the username, pwd is the password and ftpsite.com is the name 
	  // of the ftp site which you want to connect to.
	  m_pFtpConnection = m_Session.GetFtpConnection("ftpSite.com","usr","pwd",
							INTERNET_INVALID_PORT_NUMBER);
	}
	catch(CInternetException *pEx)
	{
		pEx->ReportError(MB_ICONEXCLAMATION);
		m_pFtpConnection = NULL;
		pEx->Delete();
	}
	return TRUE;</pre>
<h3>Step 4</h3><pre>
	To upload a file, add the following lines of code :- 

	CFileFind Finder;
	CString strFileName;

	// Here c:\\Myfile.bmp is the name of the file that you want to upload
	// It neednt necessarily be a bitmap file. You can upload any file that you
	// want to. 
	// The CString strFileName is used so that the same name is uploaded 
	// to the ftp server.
	// After uploading, the file in the ftp server will have the same name as 
	// your local file.You can also rename it to anything else.

	if(Finder.FindFile("C:\\Myfile.bmp")==TRUE)
	{
		Finder.FindNextFile();
		strFileName = Finder.GetFileName();
		Finder.Close();
	}

	BOOL bUploaded = m_pFtpConnection->PutFile("C:\\Myfile.bmp",strFileName,
						    FTP_TRANSFER_TYPE_BINARY,1);

	AfxMessageBox("Uploaded Successfully");</pre>
<h3>Step 5</h3><pre>
	To download a file from a ftp site, you can use the following code. 
	
	Here the first parameter is the file in the ftp server.
	The 2nd parameter is the location where you want to store it in your hard disk.

	m_pFtpConnection->GetFile("File.ext","C:\\File.ext",TRUE,
				   FILE_ATTRIBUTE_NORMAL,FTP_TRANSFER_TYPE_BINARY,1);</pre>
<h3>Step 6</h3><pre>
	To close the connection 
	
	m_Session.Close();
	m_pFtpConnection->Close();

	if(m_pFtpConnection!=NULL)
	  delete m_pFtpConnection;</pre>

<h2>Conclusion</h2><pre>
Thats it folks. Have a great time FTPing... All Luck.</pre>
</body>
</html></td>
</tr></table></div>
<div style="position:absolute;left:53;top:12;width:62;height:21;">
<table width=62 height=21 border=0 cellpadding=0 cellspacing=0><tr valign="top">
	<td align="center"><a href="http://www.geocities.com/contactgirish/tutorials.html"><font color="#000066"><span style="font-size:14">tutorials /</span></font></a></td>
</tr></table></div>
<div style="position:absolute;left:53;top:34;width:32;height:21;">
<table width=32 height=21 border=0 cellpadding=0 cellspacing=0><tr valign="top">
	<td><font color="#006600"><span style="font-size:14">ftp</span></font></td>
</tr></table></div>
<div style="position:absolute;left:13;top:12;width:40;height:21;">
<table width=40 height=21 border=0 cellpadding=0 cellspacing=0><tr valign="top">
	<td><a href="http://www.geocities.com/contactgirish/homepage.html"><font color="#000066"><span style="font-size:14">home /</span></font></a></td>
</tr></table></div>
<div style="position:absolute;left:150;top:8;width:549;height:28;">
<table width=549 height=28 border=0 cellpadding=0 cellspacing=0><tr valign="top">
	<td><!-- Top Navbar -->

<OBJECT classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
 codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=5,0,0,0"
 WIDTH=550 HEIGHT=27>
<PARAM NAME=movie VALUE="tags3x_vl.swf?tarframe=_self&exbackground=003366&makenavfield0=Code&makenavurl0=http://www.geocities.com/contactgirish/codesnippets.html&makenavfield1=Tutorials&makenavurl1=http://www.geocities.com/contactgirish/tutorials.html&makenavfield2=Downloads&makenavurl2=http://www.geocities.com/contactgirish/downloads.html&makenavfield3=Forum&makenavurl3=http://www.geocities.com/contactgirish/forum.html&makenavfield4=Links&makenavurl4=http://www.geocities.com/contactgirish/links.html&makenavfield5=Awards&makenavurl5=http://www.geocities.com/contactgirish/awards.html&makenavfield6=About&makenavurl6=http://www.geocities.com/contactgirish/AboutMe.html&makenavfield7=Search&makenavurl7=http://www.geocities.com/contactgirish/search.html">
<PARAM NAME=loop VALUE=false>
<PARAM NAME=menu VALUE=false>
<PARAM NAME=quality VALUE=high>
<PARAM NAME=scale VALUE=noborder>
<PARAM NAME=salign VALUE=LT>
<PARAM NAME=wmode VALUE=transparent>
<PARAM NAME=bgcolor VALUE=#FFFFFF>

<EMBED src="tags3x_vl.swf?tarframe=_self&exbackground=003366&makenavfield0=Code&makenavurl0=http://www.geocities.com/contactgirish/codesnippets.html&makenavfield1=Tutorials&makenavurl1=http://www.geocities.com/contactgirish/tutorials.html&makenavfield2=Downloads&makenavurl2=http://www.geocities.com/contactgirish/downloads.html&makenavfield3=Forum&makenavurl3=http://www.geocities.com/contactgirish/forum.html&makenavfield4=Links&makenavurl4=http://www.geocities.com/contactgirish/links.html&makenavfield5=Awards&makenavurl5=http://www.geocities.com/contactgirish/awards.html&makenavfield6=About&makenavurl6=http://www.geocities.com/contactgirish/AboutMe.html&makenavfield7=Search&makenavurl7=http://www.geocities.com/contactgirish/search.html" loop=false menu=false quality=high scale=noborder salign=LT wmode=transparent bgcolor=#FFFFFF  WIDTH=550 HEIGHT=27 TYPE="application/x-shockwave-flash" PLUGINSPAGE="http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash"></EMBED>

</OBJECT>

<a href="http://www.guistuff.com/"><img border="0" src="http://www.guistuff.com/images/11dot.gif" width="1" height="1"></a>



</td>
</tr></table></div>
</div>
</body>
</html>
<!-- text below generated by server. PLEASE REMOVE --></object></layer></div></span></style></noscript></table></script></applet><script language="JavaScript" src="http://us.i1.yimg.com/us.yimg.com/i/mc/mc.js"></script><script language="JavaScript" src="http://us.js2.yimg.com/us.js.yimg.com/lib/smb/js/hosting/cp/js_source/geov2_001.js"></script><script language="javascript">geovisit();</script><noscript><img src="http://visit.geocities.yahoo.com/visit.gif?us1238062031" alt="setstats" border="0" width="1" height="1"></noscript>
<IMG SRC="http://geo.yahoo.com/serv?s=76001067&t=1238062031&f=us-w82" ALT=1 WIDTH=1 HEIGHT=1>
